<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
    <title>Ashley Arthur | Swinject Thoughts and Patterns</title>
    <link rel="shortcut icon" type="image/png" href="../favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
    <link href="http://ashleyarthur.co.uk/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ashley Arthur Full Atom Feed" />
    <link rel="stylesheet" href="../theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="../theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />

    <meta name="keywords" content="Swift,iOS,Swinject" />
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="..">Home</a></li>
                <li><a href="archives.html">Archives</a></li>
                <li><a href="https://github.com/ash30">Github</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="..">Ashley Arthur</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Aug 08, 2017</h4>

            <article class="post">
                <h2 class="title">
                    <a href="../drafts/swinject-thoughts-and-patterns.html" rel="bookmark" title="Permanent Link to &quot;Swinject Thoughts and Patterns&quot;">Swinject Thoughts and Patterns</a>
                </h2>

                <p>I've written before about my admiration for swinject <INSERT HERE>, its a great dependency injection framework which
greatly helps clean up and centralise the required glue code to setup related objects.</p>
<p>Having used it throughout the development process for my side project HueInspired, I thought I'd take the time to
write about some the patterns I see around my own usage of Swinject.</p>
<h2>Application and Component Assemblers</h2>
<p>One pattern I found quite successful was one of swinject's more opininiated features: Assemblers. </p>
<p>Assembler is a protocol which defines a single function <em>Assemble</em>. The Assemblers sole responsibility
is to setup a container by registering desired factory callbacks.</p>
<p>When implementing new features to the app, I found it useful for individual features to define their own
assemblers which would later be applied to the root container. The knowledge of the object graph 
stays encapsulated within the feature whilst offering and easy way for clients to construct it.</p>
<h2>Private Containers</h2>
<p>Sometimes we want the feature to register factories but not have them exposed to anyone who would 
include the assembler, they might expose construction of internal types that you want to keep isolated to the feature.
Or they may leak implementation details like Core data.</p>
<h2>Containers as Abstract Factories</h2>
<p>If you register and rely on a protocol as your resolve target, you can effectively hide the implementation
from the client. This ties in naturally with feature level assemblers which already encapsulate the knowledge
required to setup the supporting objects in the graph.</p>
<p>In HueInspired, we are able to provide data layer objects without exposing the fact we're using Core Data</p>
<h2>Conditional inclusion of features</h2>
<p>When features provide their own assemblers, we can conditionally include them in the app, opening the way
to ideas like feature flags etc.</p>
<p>In Hueinspired we have certain debug flags that change how we construct the initial object graph. </p>
<h2>Rules for unwrapping resolve calls</h2>
<p>As we must rely on other assemblers registering factories, we cannot always be sure if the resolve call will be fulfilled.
Hence I try and stick to the following rules</p>
<ol>
<li>If the current assembler registers the factory then you can safely force unwrap</li>
<li>If Type is specified in Core, we can generally force unwrap</li>
<li>Else it should be left as optional</li>
</ol>
<h2>Creating components at runtime</h2>
<p>Not all objects are constructed at startup, for example we may need to construct a view controller and segue to it based on
a user interaction. Instead of hard coding the next view controller into the calling code, we can express it as dependency
that can injected in as required. </p>
<p>The idea is to define a callback property that provides the next view controller but only exposes itself 
via the ViewController type. The initial construction of the object will inject in the factory so you are able centralise
construction logic in the container and just give out a strict interface.</p>
<p>This is prefered to having an object take the container as a dependency.</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="../drafts/swinject-thoughts-and-patterns.html">posted at 00:00</a>
                    &nbsp;&middot;&nbsp;<a href="../category/tech.html" rel="tag">Tech</a>
                    &nbsp;&middot;
                    &nbsp;<a href="../tag/swift.html" class="tags">Swift</a>
                    &nbsp;<a href="../tag/ios.html" class="tags">iOS</a>
                    &nbsp;<a href="../tag/swinject.html" class="tags">Swinject</a>
                </div>
            </article>
            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="../feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>